<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Transform Library Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }

        .canvas-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        canvas {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            display: block;
            width: 100%;
        }

        .controls {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow-y: auto;
            max-height: 600px;
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-group h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-item {
            margin-bottom: 12px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
            font-size: 0.9em;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e0e0e0;
            outline: none;
            
        }

        input[type="range"]::-webkit-slider-thumb {
            
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }

        .value-display {
            display: inline-block;
            margin-left: 10px;
            color: #667eea;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        button:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: #764ba2;
        }

        button.secondary:hover {
            background: #653a8a;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .info-box h4 {
            color: #667eea;
            margin-bottom: 8px;
        }

        .info-box pre {
            background: white;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.85em;
            color: #333;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }

        .preset-buttons button {
            padding: 8px;
            font-size: 0.85em;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ 3D Transform Library</h1>
            <p class="subtitle">Interactive 3D Transformations Visualizer</p>
        </header>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="canvas3d"></canvas>
            </div>

            <div class="controls">
                <div class="control-group">
                    <h3>üìç Translation</h3>
                    <div class="control-item">
                        <label>X Position <span class="value-display" id="tx-value">0.00</span></label>
                        <input type="range" id="tx" min="-3" max="3" step="0.1" value="0">
                    </div>
                    <div class="control-item">
                        <label>Y Position <span class="value-display" id="ty-value">0.00</span></label>
                        <input type="range" id="ty" min="-3" max="3" step="0.1" value="0">
                    </div>
                    <div class="control-item">
                        <label>Z Position <span class="value-display" id="tz-value">0.00</span></label>
                        <input type="range" id="tz" min="-3" max="3" step="0.1" value="0">
                    </div>
                </div>

                <div class="control-group">
                    <h3>üîÑ Rotation (degrees)</h3>
                    <div class="control-item">
                        <label>X Rotation <span class="value-display" id="rx-value">0¬∞</span></label>
                        <input type="range" id="rx" min="0" max="360" step="1" value="0">
                    </div>
                    <div class="control-item">
                        <label>Y Rotation <span class="value-display" id="ry-value">0¬∞</span></label>
                        <input type="range" id="ry" min="0" max="360" step="1" value="0">
                    </div>
                    <div class="control-item">
                        <label>Z Rotation <span class="value-display" id="rz-value">0¬∞</span></label>
                        <input type="range" id="rz" min="0" max="360" step="1" value="0">
                    </div>
                </div>

                <div class="control-group">
                    <h3>üìè Scale</h3>
                    <div class="control-item">
                        <label>X Scale <span class="value-display" id="sx-value">1.00</span></label>
                        <input type="range" id="sx" min="0.1" max="3" step="0.1" value="1">
                    </div>
                    <div class="control-item">
                        <label>Y Scale <span class="value-display" id="sy-value">1.00</span></label>
                        <input type="range" id="sy" min="0.1" max="3" step="0.1" value="1">
                    </div>
                    <div class="control-item">
                        <label>Z Scale <span class="value-display" id="sz-value">1.00</span></label>
                        <input type="range" id="sz" min="0.1" max="3" step="0.1" value="1">
                    </div>
                </div>

                <div class="control-group">
                    <h3>üé¨ Presets</h3>
                    <div class="preset-buttons">
                        <button onclick="applyPreset('identity')">Reset</button>
                        <button onclick="applyPreset('spin')">Spin</button>
                        <button onclick="applyPreset('scale')">Scale Up</button>
                        <button onclick="applyPreset('move')">Move</button>
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="toggleAnimation()">‚ñ∂ Animate</button>
                    <button class="secondary" onclick="randomTransform()">üé≤ Random</button>
                </div>

                <div class="info-box">
                    <h4>üìä Transform Matrix</h4>
                    <pre id="matrix-display">Identity Matrix</pre>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Vector3 Class
        class Vector3 {
            constructor(x = 0, y = 0, z = 0) {
                this.x = x; this.y = y; this.z = z;
            }
            clone() { return new Vector3(this.x, this.y, this.z); }
            set(x, y, z) { this.x = x; this.y = y; this.z = z; return this; }
            add(v) { this.x += v.x; this.y += v.y; this.z += v.z; return this; }
            applyMatrix4(m) {
                const x = this.x, y = this.y, z = this.z;
                const e = m.elements;
                const w = 1 / (e[3] * x + e[7] * y + e[11] * z + e[15]);
                this.x = (e[0] * x + e[4] * y + e[8] * z + e[12]) * w;
                this.y = (e[1] * x + e[5] * y + e[9] * z + e[13]) * w;
                this.z = (e[2] * x + e[6] * y + e[10] * z + e[14]) * w;
                return this;
            }
        }

        // Matrix4 Class
        class Matrix4 {
            constructor() {
                this.elements = [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
            }
            identity() {
                this.elements = [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];
                return this;
            }
            multiply(m) {
                const ae = this.elements, be = m.elements, te = [];
                for (let i = 0; i < 4; i++) {
                    for (let j = 0; j < 4; j++) {
                        te[i * 4 + j] = ae[i * 4] * be[j] + ae[i * 4 + 1] * be[j + 4] + 
                                        ae[i * 4 + 2] * be[j + 8] + ae[i * 4 + 3] * be[j + 12];
                    }
                }
                this.elements = te;
                return this;
            }
            makeTranslation(x, y, z) {
                this.elements = [1,0,0,0,0,1,0,0,0,0,1,0,x,y,z,1];
                return this;
            }
            makeRotationX(theta) {
                const c = Math.cos(theta), s = Math.sin(theta);
                this.elements = [1,0,0,0,0,c,s,0,0,-s,c,0,0,0,0,1];
                return this;
            }
            makeRotationY(theta) {
                const c = Math.cos(theta), s = Math.sin(theta);
                this.elements = [c,0,-s,0,0,1,0,0,s,0,c,0,0,0,0,1];
                return this;
            }
            makeRotationZ(theta) {
                const c = Math.cos(theta), s = Math.sin(theta);
                this.elements = [c,s,0,0,-s,c,0,0,0,0,1,0,0,0,0,1];
                return this;
            }
            makeScale(x, y, z) {
                this.elements = [x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1];
                return this;
            }
        }

        // Transform Class
        class Transform {
            constructor() {
                this.position = new Vector3();
                this.rotation = new Vector3();
                this.scale = new Vector3(1, 1, 1);
                this.matrix = new Matrix4();
            }
            setPosition(x, y, z) { this.position.set(x, y, z); this.updateMatrix(); return this; }
            setRotationDegrees(x, y, z) {
                this.rotation.set(x * Math.PI / 180, y * Math.PI / 180, z * Math.PI / 180);
                this.updateMatrix(); return this;
            }
            setScale(x, y, z) { this.scale.set(x, y, z); this.updateMatrix(); return this; }
            updateMatrix() {
                const t = new Matrix4().makeTranslation(this.position.x, this.position.y, this.position.z);
                const rx = new Matrix4().makeRotationX(this.rotation.x);
                const ry = new Matrix4().makeRotationY(this.rotation.y);
                const rz = new Matrix4().makeRotationZ(this.rotation.z);
                const s = new Matrix4().makeScale(this.scale.x, this.scale.y, this.scale.z);
                this.matrix.identity().multiply(t).multiply(rz).multiply(ry).multiply(rx).multiply(s);
            }
            transformPoint(p) { const pt = p.clone(); pt.applyMatrix4(this.matrix); return pt; }
        }

        // Canvas3D Class
        class Canvas3D {
            constructor(id) {
                this.canvas = document.getElementById(id);
                this.ctx = this.canvas.getContext('2d');
                this.resize();
                this.fov = 500;
                this.viewDistance = 5;
            }
            resize() {
                const parent = this.canvas.parentElement;
                this.canvas.width = parent.clientWidth - 40;
                this.canvas.height = 600;
            }
            clear() {
                this.ctx.fillStyle = '#1a1a2e';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
            }
            project(p) {
                const scale = this.fov / (this.viewDistance + p.z);
                return {
                    x: p.x * scale + this.canvas.width / 2,
                    y: -p.y * scale + this.canvas.height / 2,
                    scale
                };
            }
            drawLine(s, e, color = '#fff', width = 2) {
                const p1 = this.project(s), p2 = this.project(e);
                this.ctx.strokeStyle = color;
                this.ctx.lineWidth = width;
                this.ctx.beginPath();
                this.ctx.moveTo(p1.x, p1.y);
                this.ctx.lineTo(p2.x, p2.y);
                this.ctx.stroke();
            }
            drawAxes(len = 2) {
                this.drawLine(new Vector3(0,0,0), new Vector3(len,0,0), '#ff6b6b', 3);
                this.drawLine(new Vector3(0,0,0), new Vector3(0,len,0), '#4ecdc4', 3);
                this.drawLine(new Vector3(0,0,0), new Vector3(0,0,len), '#45b7d1', 3);
            }
            drawGrid(size = 4, divs = 8) {
                const step = size / divs, half = size / 2;
                for (let i = 0; i <= divs; i++) {
                    const y = -half + i * step;
                    this.drawLine(new Vector3(-half, y, 0), new Vector3(half, y, 0), '#16213e', 1);
                }
                for (let i = 0; i <= divs; i++) {
                    const x = -half + i * step;
                    this.drawLine(new Vector3(x, -half, 0), new Vector3(x, half, 0), '#16213e', 1);
                }
            }
            drawCube(pts, color = '#00ff88') {
                const lines = [[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];
                lines.forEach(([a, b]) => this.drawLine(pts[a], pts[b], color, 2));
            }
        }

        // Initialize
        const canvas = new Canvas3D('canvas3d');
        const transform = new Transform();
        const cubeVerts = [
            new Vector3(-1,-1,-1), new Vector3(1,-1,-1), new Vector3(1,1,-1), new Vector3(-1,1,-1),
            new Vector3(-1,-1,1), new Vector3(1,-1,1), new Vector3(1,1,1), new Vector3(-1,1,1)
        ];

        let isAnimating = false;
        let animFrame = 0;

        // Update display
        function update() {
            canvas.clear();
            canvas.drawGrid();
            canvas.drawAxes();
            const transformed = cubeVerts.map(v => transform.transformPoint(v));
            canvas.drawCube(transformed);
            
            const e = transform.matrix.elements;
            document.getElementById('matrix-display').textContent = 
                `[${e[0].toFixed(2)} ${e[4].toFixed(2)} ${e[8].toFixed(2)} ${e[12].toFixed(2)}]\n` +
                `[${e[1].toFixed(2)} ${e[5].toFixed(2)} ${e[9].toFixed(2)} ${e[13].toFixed(2)}]\n` +
                `[${e[2].toFixed(2)} ${e[6].toFixed(2)} ${e[10].toFixed(2)} ${e[14].toFixed(2)}]\n` +
                `[${e[3].toFixed(2)} ${e[7].toFixed(2)} ${e[11].toFixed(2)} ${e[15].toFixed(2)}]`;
        }

        // Setup controls
        ['tx','ty','tz'].forEach((id, i) => {
            const input = document.getElementById(id);
            input.oninput = () => {
                const val = parseFloat(input.value);
                document.getElementById(id + '-value').textContent = val.toFixed(2);
                transform.setPosition(
                    parseFloat(document.getElementById('tx').value),
                    parseFloat(document.getElementById('ty').value),
                    parseFloat(document.getElementById('tz').value)
                );
                update();
            };
        });

        ['rx','ry','rz'].forEach(id => {
            const input = document.getElementById(id);
            input.oninput = () => {
                const val = parseFloat(input.value);
                document.getElementById(id + '-value').textContent = val + '¬∞';
                transform.setRotationDegrees(
                    parseFloat(document.getElementById('rx').value),
                    parseFloat(document.getElementById('ry').value),
                    parseFloat(document.getElementById('rz').value)
                );
                update();
            };
        });

        ['sx','sy','sz'].forEach(id => {
            const input = document.getElementById(id);
            input.oninput = () => {
                const val = parseFloat(input.value);
                document.getElementById(id + '-value').textContent = val.toFixed(2);
                transform.setScale(
                    parseFloat(document.getElementById('sx').value),
                    parseFloat(document.getElementById('sy').value),
                    parseFloat(document.getElementById('sz').value)
                );
                update();
            };
        });

        window.applyPreset = (type) => {
            const presets = {
                identity: {tx:0,ty:0,tz:0,rx:0,ry:0,rz:0,sx:1,sy:1,sz:1},
                spin: {tx:0,ty:0,tz:0,rx:45,ry:45,rz:45,sx:1,sy:1,sz:1},
                scale: {tx:0,ty:0,tz:0,rx:0,ry:0,rz:0,sx:2,sy:2,sz:2},
                move: {tx:1.5,ty:1,tz:0.5,rx:0,ry:0,rz:0,sx:1,sy:1,sz:1}
            };
            const p = presets[type];
            Object.keys(p).forEach(k => {
                document.getElementById(k).value = p[k];
                document.getElementById(k).oninput();
            });
        };

        window.toggleAnimation = () => {
            isAnimating = !isAnimating;
            if (isAnimating) animate();
        };

        window.randomTransform = () => {
            ['tx','ty','tz'].forEach(id => {
                const val = (Math.random() - 0.5) * 4;
                document.getElementById(id).value = val;
                document.getElementById(id).oninput();
            });
            ['rx','ry','rz'].forEach(id => {
                const val = Math.random() * 360;
                document.getElementById(id).value = val;
                document.getElementById(id).oninput();
            });
        };

        function animate() {
            if (!isAnimating) return;
            animFrame++;
            const ry = (animFrame * 2) % 360;
            document.getElementById('ry').value = ry;
            document.getElementById('ry').oninput();
            requestAnimationFrame(animate);
        }

        update();
    </script>
</body>
</html>